{"status":{},"contains_secrets":true,"product_version":"2.9.8.1","spec":{"description":"Splunk 8.0.3 - 60 day trial of Enterprise\nSmart store will be configured via the variables.\nWhen configuring S3 buckets:\n1) The buckets must have read, write, and delete permissions.\n","resources":{"client_attrs":{"None":{"y":-174.5,"x":371.25},"0cef6335_deployment_cloned_0_cloned_0":{"y":-243.1251787875,"x":691.9035381762},"0cef6335_deployment_cloned_0":{"y":-237.1239337803,"x":349.2966811172},"0cef6335_deployment":{"y":-241.7038538528,"x":502.8241319589}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"436b8806_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6fa942e0_runbook","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a33e37d9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffa55735_runbook","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e3e43d46_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42f57ffc_runbook","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c56edf45_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ab6e619_runbook","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2cd45802_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"642b36dd_runbook","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag"},"variable_list":[]},"name":"action_stop"}],"depends_on_list":[],"name":"Splunk_INDX","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"436b8806_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6fa942e0_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a33e37d9_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffa55735_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e3e43d46_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42f57ffc_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag_cloned_1"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c56edf45_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ab6e619_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2cd45802_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"642b36dd_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag_cloned_1"},"variable_list":[]},"name":"action_stop"}],"depends_on_list":[],"name":"Splunk_Master","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"436b8806_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6fa942e0_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a33e37d9_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffa55735_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e3e43d46_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42f57ffc_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c56edf45_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ab6e619_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2cd45802_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"642b36dd_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_stop"}],"depends_on_list":[],"name":"Splunk_SH","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Indexer_set_ip"}],"name":"1ed49871_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Indexer_set_ip","attrs":{"exit_status":[],"script":"print \"indexer_nic_ipaddr=@@{indexer_ip_range[calm_array_index]}@@\"","eval_variables":["indexer_nic_ipaddr"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"d46d8842_runbook","main_task_local_reference":{"kind":"app_task","name":"1ed49871_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"cb1a56e7_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"61575fda_runbook","main_task_local_reference":{"kind":"app_task","name":"cb1a56e7_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"SplunkINDX","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"editables":{"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{SERVER_NAME}@@-INDX-@@{calm_unique}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[{"ip":"@@{indexer_nic_ipaddr}@@","type":"ASSIGNED"}],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"39e04fe9-f004-4143-82a6-e7ba4caf5597"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":12,"gpu_list":[],"memory_size_mib":12288,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n  - name: splunk\n    lock_passwd: false\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    \nssh_pwauth: True\nchpasswd:\n  list: |\n    root:@@{Root.secret}@@\n    splunk:@@{splunk.secret}@@\n  expire: false\n   "},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"192944ef-45cd-4a25-8ece-7a1b126310ba","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7.qcow2","uuid":"185dcd49-fc60-4fcc-ad57-7174a477e9a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":20480,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":2,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":3,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":4,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":5,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":6,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":7,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkMaster"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"5400482d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"f1a3bfe7_runbook","main_task_local_reference":{"kind":"app_task","name":"5400482d_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkMaster"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"1a5177e1_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9fed1d97_runbook","main_task_local_reference":{"kind":"app_task","name":"1a5177e1_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"SplunkMaster","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"editables":{"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{SERVER_NAME}@@-Master-@@{calm_unique}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"39e04fe9-f004-4143-82a6-e7ba4caf5597"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":6,"gpu_list":[],"memory_size_mib":6144,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n  - name: splunk\n    lock_passwd: false\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    \nssh_pwauth: True\nchpasswd:\n  list: |\n    root:@@{Root.secret}@@\n    splunk:@@{splunk.secret}@@\n  expire: false\n   \nmounts:\n  - [\/dev\/sdb1, \/opt\/splunk, \"auto\", \"defaults\", \"0\", \"0\" ]"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"192944ef-45cd-4a25-8ece-7a1b126310ba","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":null,"type":"","disk_size_mib":81920,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":{"kind":"image","type":"","name":"CentOS7.qcow2","uuid":"185dcd49-fc60-4fcc-ad57-7174a477e9a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"sh_nic_apaddr"}],"name":"c96a0722_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"sh_nic_apaddr","attrs":{"exit_status":[],"script":"print \"sh_nic_ipaddr=@@{sh_ip_range[calm_array_index]}@@\"","eval_variables":["sh_nic_ipaddr"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"10865c27_runbook","main_task_local_reference":{"kind":"app_task","name":"c96a0722_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"25c98921_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"039d045f_runbook","main_task_local_reference":{"kind":"app_task","name":"25c98921_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"SplunkSH","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"editables":{"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{SERVER_NAME}@@-SH-@@{calm_unique}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[{"ip":"@@{sh_nic_ipaddr}@@","type":"ASSIGNED"}],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"39e04fe9-f004-4143-82a6-e7ba4caf5597"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":6,"gpu_list":[],"memory_size_mib":6144,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n  - name: splunk\n    lock_passwd: false\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    \nssh_pwauth: True\nchpasswd:\n  list: |\n    root:@@{Root.secret}@@\n    splunk:@@{splunk.secret}@@\n  expire: false\n   \nmounts:\n  - [\/dev\/sdb1, \/opt\/splunk, \"auto\", \"defaults\", \"0\", \"0\" ]"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"192944ef-45cd-4a25-8ece-7a1b126310ba","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7.qcow2","uuid":"185dcd49-fc60-4fcc-ad57-7174a477e9a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":81920,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"centos","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"uhpp7nbaalc04ytPkIuU9WPkk0mJqrvJIN9muxwh519+34tlnBEsSEFcHeOJ9TfGpaSzX0D1zWpuIStVosHmss8rFGNcbt+We0GqNqSIbsM2H62a4EWldV\/riKZdkAQCWCxwbw5bjW2\/hmcQ5ABb2Ra095z80R3LVonXWrDNaMCOpbQmg5fiV1CeDVWY7tu82KHQNu1wHvQrC6CNBzx74wEe6C4RNJCMmQlBxY6C4QaUMNVv4m2THuXHvOoZjxBNf6n1q6tyk+\/20gozUm+jILPCB7E2YfknMiNYW9IiFxrr2CWwdKebYbA8b7va2CbkhBXZavBK6RFgA0RNPDDxRiPB\/IOiuLcf1XsIPSJlHgKZg4h43cmQEXuZgh5A6rNmZ++hknEM125vNXQuYtibGKw\/5ovbdg9rkUXWLaBa0zkalRl\/S5nAEEKr65VKVbTdsz4hbOFKt1ABpuuF6Ua5E9l3oyK9gIWIj4a60W\/UP5KG0EVjYNj3L0tm8CBHGICc+96a5p64upexZNYeiVuMAvQlRJzoHX6rlzu72LEF7m+Oj0K2Il5X934UnJ1HjsUrIO7kG2LUK4FipsGxCpTZaUJ4F1gPRgojbjm0vU5rld\/f0\/Z0Dl\/idB9sXEFCftFv\/4DWGCydqRK01wYFjHu3iqTO3W9MagitiTkf5+jNTFdRkGOgEsPQrSVAc4PkYkhM2MtiLf+ZYyHmaWMRct9ZM8rOlwI61hWdd+9uvRwWaCveJDdOO9WhSe2lrilgMz\/up2F\/SMCzJafzfC7C3Gi7FGOTJd1MoSFuQ0z3xOr6b3PavXBSx02h73lBjiPNR4rqervvZrd1gOyat++j932g1lYNhEq4ttprkcIpex3lYKVjNefIllEqBIlxNrldS9kuZAI6Ou5oRYiIAVt6WmnU5ebGt+pHzWPUbLvpb7SWdL+OjNq\/RAM2huH5JVOhZQ1HvztlfXwItQ93\/k4ajAxTQlgiYDHLYK4aSv5VJUkPJr8AZyA8x+jH8+howjm31yjwdhbVa0ogODbq\/2cySBCO1K55egZukqU3FOHAThsrOFHztgF7j3Y0bIBhy4GyqEdoX8+tjKpJDLU93dLvRkj8ljdETW1rZtEPMNbQwieJmiGDr\/Y+vyqw\/i0njcD9B7lJA6TNOD0Y\/\/ka1s8fWNXsKKw9zOXgwk2RBYm9rrgc+pxVA5mhq7BCyK5oV\/4oDGqgYvYISuzVwO9vZMDQfZsdJpS\/u2UQYvncxG+iEEZA2pMmbD6EFcM6cUxMyf21Et\/bSjASv67QF+Sc5fyMPZJE17bY44mnukQrNaIRSch0hS94ahUVe782qi05llgDuOOsRKkMIwCSxdNz0hbvqlyRaO3S4a3YOQlxfC+0XMaCUNefFK8KvbBZvmjY7NHMJVmUMFN3Bydq7FTQJuwBgu+BunkPzrG9PvSE21DAL5H0pl+s55n6tZapyy8nNBRWtNrcMp61af2eVQjKPSYmFS\/05MloPCdKAvnslc6ulvLLdwcK3TqnS37POrKC9lZCQP4Ju80KOS5zXl3iUoo90g9Z0oe67tQJv+uNnB1hYF5NTUWzspWMz\/+hFE2mJe\/xDNHVcJtCz7CRWweJDNb1YC38lgJ6yFVC1MR\/CXm5bACxWMjb3f93xw7rYmPNXcMvQj2fS5bzwh4vH4M7m7MM3yNcdvqi9cLyf9l9KlA\/mj51wTNnurDUjAKGcM0lBoGMaLRtXamn3BJS\/1OIHPL0oR1p0miLV45zEiKADQlpYosQe5gFRVaKvNUqxDzT\/hdc977ecFuKfKtpzSwouB4c+VJDEsgFN29JLAKHXURCaOXU0Z0RhVxEFwz\/eY9J3i5TPRebBfX\/5Hag020fKdCJV1T74YMvqyJBsj\/OmkB3gRuF2NsqCAVaTJFNqmFfqZBa\/E7bYAAx4F39SGalBCm5ZhYZVizltEHP5PHhoY+RTeBJUFxhEYu7xQZPCDdGKvlUDLWubNDrcuRv6dpZWzGM7v5OUXqpaeVlgBl00vFfT2aaBryXscioAVTY\/W8GT2zE3M12KuS5jzA08DCbLGBFxKmdxYB7r\/fJvJrHZ9LkdUd\/oi60RQC7WiWaX5Q8JMrRw\/SijnfAOG89GAI70S+vbeqfXelQqzupJUQYWrdaA2TMyqsp49xDjWR5MYFsJnscnbJRL1EEMNu\/2h6Enb\/OPgKq+YLIokcFr\/Z3jLKedv+KA7fwS0HllpsBYhmY7gYoTqTWbDBPwgMTKrNIj17lE0QlOu41ndbAvKF3l14L0KeOrE7pL04XfVFVFd7sTOEhQiUImI1iEH1ugFFADgaM+GSP\/N7rPPElPEDr2EU2TGgVlGXj86iDCEsEOh0hF6seSHlFUYVqdbZ6tIjYQHINugQfVM1AFNEWLlLxOxK93QOV0Hf+utOMJFAKIlP0MhnWsM1ArRMkaCE6KmoK2WV3yRgun02xrQGzkTIGf7lRBrhN3NLRgrqYTyTu8N777e31IpPPVmo\/:utf-8"},"name":"Splunk_VM"},{"username":"root","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"kup7rPAtGXdGZ841dO9gLpaya4uXB22RrOWz8QGtHSSGul5P29ebN8v5:utf-8"},"name":"Root"},{"username":"splunk","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"40RXlP497WFCgQz4qk6um9+txhpO5\/yuGr04KANautZ0KneNFoMGYi4r:utf-8"},"name":"splunk"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Splunk_INDX"}],"name":"Package1","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Add Disk"},{"kind":"app_task","name":"Setup_OS"},{"kind":"app_task","name":"Install_INDX"}],"name":"8b8e1190_dag","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Add Disk"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Setup_OS"}},{"from_task_reference":{"kind":"app_task","name":"Setup_OS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_INDX"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Add Disk","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n# install LVM\nsudo yum install -y lvm2\n\n# Prep LVM pvols\nsudo pvcreate -y \/dev\/sd[b-g]\n\n# Create Splunk DIR\nsudo mkdir \/opt\/splunk\n\n# 6 disk LVM\nsudo vgcreate splunk_vg6 \/dev\/sd[b-g]\nsudo lvcreate -l 100%FREE -i 6 -I 64 -n splunk_vol6 splunk_vg6\nsudo mkfs.ext4 -F -m 1 -v \/dev\/splunk_vg6\/splunk_vol6\nsudo tune2fs -o journal_data_writeback \/dev\/splunk_vg6\/splunk_vol6\n\n# Write mounts to fstab\necho \"\/dev\/splunk_vg6\/splunk_vol6 \/opt\/splunk ext4 noatime,data=writeback,barrier=0,nobh,errors=remount-ro 0 1\" | sudo tee -a \/etc\/fstab\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Setup_OS","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set Firewalld to stop and disable\nsudo systemctl stop firewalld\nsudo systemctl disable firewalld\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@-@@{calm_unique}@@\nsudo hostnamectl status\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install_INDX","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\n# Fetch Splunk binary\nwget -O splunk-8.0.3-a6754d8441bf-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=8.0.3&product=splunk&filename=splunk-8.0.3-a6754d8441bf-Linux-x86_64.tgz&wget=true'\n\n# User and Group\nsudo mount -a\n# sudo mkdir \/opt\/splunk\nsudo groupadd splunk\nsudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Untar the binaries\ngunzip splunk-8.0.3-a6754d8441bf-Linux-x86_64.tgz\ntar -xvf splunk-8.0.3-a6754d8441bf-Linux-x86_64.tar\n\n# Rum SPlunk RPM\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\nsudo chown -R splunk: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\n#splunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Copy data to server.conf for slave nodes\n# export MasterIP=@@{Splunk_Master.address}@@\n# MasterIP = MIP:8089\necho '[replication_port:\/\/9887]'  >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'master_uri = https:\/\/@@{Splunk_Master.address}@@:8089' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = slave' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n\n# Pause for 60 seconds to allow Master node to come online\n#sleep 60s\n\n\n# Start the splunk service again\nsplunk restart\n\necho 'Splunk Install Complete!'","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1981290_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"ef4a5c16_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"74e6f4b4_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Splunk_Master"}],"name":"Package_Master","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Add Disk"},{"kind":"app_task","name":"Setup_OS"},{"kind":"app_task","name":"Install_Master"},{"kind":"app_task","name":"Enable SmartStore"}],"name":"8b8e1190_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install_Master"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Enable SmartStore"}},{"from_task_reference":{"kind":"app_task","name":"Add Disk"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Setup_OS"}},{"from_task_reference":{"kind":"app_task","name":"Setup_OS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_Master"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Add Disk","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n#fdisk New disk\nprintf 'o\\nn\\np\\n1\\n\\n\\nw' | fdisk \/dev\/sda\n\n#Sleep 5s for partition to complete\nsleep 5s\n\n#New disk make xfs\nmkfs.xfs \/dev\/sda1\n\n#mount disk\nmount \/dev\/sda1 \/opt\/splunk","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Setup_OS","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set Firewalld to stop and disable\nsudo systemctl stop firewalld\nsudo systemctl disable firewalld\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@\nsudo hostnamectl status\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install_Master","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\n# Fetch Splunk binary\nwget -O splunk-8.0.3-a6754d8441bf-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=8.0.3&product=splunk&filename=splunk-8.0.3-a6754d8441bf-Linux-x86_64.tgz&wget=true'\n\n# User and Group\nsudo mount -a\n# sudo mkdir \/opt\/splunk\nsudo groupadd splunk\nsudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Untar the binaries\ngunzip splunk-8.0.3-a6754d8441bf-Linux-x86_64.tgz\ntar -xvf splunk-8.0.3-a6754d8441bf-Linux-x86_64.tar\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\nsudo chown -R splunk: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\nsplunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Set Master node config\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = master' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'replication_factor = 1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'search_factor = 1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'cluster_label = cluster1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n# Start the splunk service again\nsplunk start\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Enable SmartStore","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\nSmart Store S3 Setup\necho '[default]' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho 'remotePath = volume:s3\/$_index_name' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho '' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho '[volume:s3]'  >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho 'storageType = remote' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho 'path = s3:\/\/@@{BucketVolume}@@\/' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho 'remote.s3.access_key = @@{S3_ACCESS_KEY}@@' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho 'remote.s3.secret_key = @@{S3_SECRET_KEY}@@' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho 'remote.s3.endpoint = https:\/\/@@{Bucket_name_IP}@@' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho 'remote.s3.auth_region = us-east-1' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho '' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho '[cs_index]' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho 'homePath = $SPLUNK_DB\/cs_index\/db' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n# SmartStore-enabled indexes do not use thawedPath or coldPath, but you must still specify them here.\necho 'coldPath = $SPLUNK_DB\/cs_index\/colddb' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\necho 'thawedPath = $SPLUNK_DB\/cs_index\/thaweddb' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n\nSend Change\ncd \/opt\/splunk\/bin\n.\/splunk login -auth admin:@@{SPLUNK_ADMIN_PASSWORD}@@\n.\/splunk apply cluster-bundle --answer-yes\n\necho 'Splunk Install Complete!'","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1981290_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"ef4a5c16_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"74e6f4b4_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Splunk_SH"}],"name":"Package_SH","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Add Disk"},{"kind":"app_task","name":"Setup_OS"},{"kind":"app_task","name":"Install_SH"}],"name":"8b8e1190_dag_cloned_1_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Setup_OS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_SH"}},{"from_task_reference":{"kind":"app_task","name":"Add Disk"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Setup_OS"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Add Disk","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n#fdisk New disk\nprintf 'o\\nn\\np\\n1\\n\\n\\nw' | fdisk \/dev\/sdb\n\n#Sleep 5s for partition to complete\nsleep 5s\n\n#New disk make xfs\nmkfs.xfs \/dev\/sdb1\n\n#mount disk\nmount \/dev\/sdb1 \/opt\/splunk","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Setup_OS","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set Firewalld to stop and disable\nsudo systemctl stop firewalld\nsudo systemctl disable firewalld\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@\nsudo hostnamectl status\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install_SH","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\n# Fetch Splunk binary\nwget -O splunk-8.0.3-a6754d8441bf-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=8.0.3&product=splunk&filename=splunk-8.0.3-a6754d8441bf-Linux-x86_64.tgz&wget=true'\n\n# User and Group\nsudo mount -a\n# sudo mkdir \/opt\/splunk\nsudo groupadd splunk\nsudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Untar the binaries\ngunzip splunk-8.0.3-a6754d8441bf-Linux-x86_64.tgz\ntar -xvf splunk-8.0.3-a6754d8441bf-Linux-x86_64.tar\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\nsudo chown -R splunk: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\nsplunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Copy data to server.conf for slave nodes\n# export MasterIP=@@{Splunk_Master.address}@@\n#MasterIP=MIP:8089\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'master_uri = https:\/\/@@{Splunk_Master.address}@@:8089' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = searchhead' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n# Pause for 60 seconds to allow Master node to come online\npause 60\n\n# Start the splunk service again\nsplunk start --answer-yes --no-prompt --accept-license\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1981290_runbook_cloned_0_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag_cloned_1_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"ef4a5c16_dag_cloned_1_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"74e6f4b4_runbook_cloned_0_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag_cloned_1_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"0cef6335_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"5","package_local_reference_list":[{"kind":"app_package","name":"Package1"}],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"0cef6335_deployment_cloned_0","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package_Master"}],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkMaster"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"0cef6335_deployment_cloned_0_cloned_0","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Package_SH"}],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"Splunk_App_Profile","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"INSTANCE_PUBLIC_KEY","value":"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCiK81m7NPZ47wd1yr3o\/gQQJiAJem5gnUVqgRiSPp8\/T\/Q+msDV490nZXlM1vLO2dT5wmtM6znghwDkr5qkxo51fNVtBsqplElQXHKJ2VHiXnF4FErYN8zaXsFLuObcWW6Fx+sOZHapXjEkpJbMdRBtNABh0yn6H5EJOw8DPHeUnwZfgPuCIUwZ7nxP+bSoDSaREYXuhN8lgQyzQH2BTHfwsntZtDtEvyR7\/10FUsHMCMLayeDM3eMLCkCqN4twMF8AUdc\/eZ6utjc5Iqdd98BFxlPj1CxhfWuRcTQNnZRJyfzqmNWnG8oJayGUg\/NnkHq1D2VAzd3uK\/5LDyOCQ2\/ james.brown@JBrownIA-MBP1.local","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SERVER_NAME","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"SPLUNK_ADMIN_PASSWORD","value":"yIBY6QJTDKs7\/\/2umPlHcyF5wkdWeOcK\/HvAY\/xqodA=:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"SPLUNK_LICENSE","value":"+1N3IqjFJvEixvZyJwpxgpfuGCFIXmAG4CsqOJKLn7g=:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"BucketVolume","value":"splunk-cold","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"S3_ACCESS_KEY","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"S3_SECRET_KEY","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Bucket_name_IP","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"indexer_ip_range","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"sh_ip_range","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"type":"USER"},"name":"Splunk-StaticIP-SmartStore"},"api_version":"3.0","metadata":{"last_update_time":"1585943961617549","kind":"blueprint","spec_version":3,"creation_time":"1585943627792296","name":"Splunk-StaticIP-SmartStore"}}