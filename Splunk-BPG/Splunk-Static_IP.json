{"status":{},"contains_secrets":true,"product_version":"2.9.7.1","spec":{"description":"Splunk 7.3.1.1 - 60 day trial of Enterprise\nSmart store will be configured via the variables.\nWhen configuring S3 buckets:\n1) The buckets must have read, write, and delete permissions.\n","resources":{"client_attrs":{"None":{"y":-174.5,"x":371.25},"0cef6335_deployment_cloned_0_cloned_0":{"y":-236.7851314877,"x":667.8113584369},"0cef6335_deployment_cloned_0":{"y":-246,"x":258},"0cef6335_deployment":{"y":-240.4358443928,"x":460.9798197802}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"436b8806_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6fa942e0_runbook","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a33e37d9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffa55735_runbook","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e3e43d46_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42f57ffc_runbook","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c56edf45_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ab6e619_runbook","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2cd45802_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"642b36dd_runbook","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag"},"variable_list":[]},"name":"action_stop"}],"depends_on_list":[],"name":"Splunk_INDX","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"436b8806_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6fa942e0_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a33e37d9_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffa55735_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e3e43d46_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42f57ffc_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag_cloned_1"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c56edf45_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ab6e619_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2cd45802_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"642b36dd_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag_cloned_1"},"variable_list":[]},"name":"action_stop"}],"depends_on_list":[],"name":"Splunk_Master","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"436b8806_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6fa942e0_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a33e37d9_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffa55735_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e3e43d46_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42f57ffc_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c56edf45_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ab6e619_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2cd45802_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"642b36dd_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_stop"}],"depends_on_list":[],"name":"Splunk_SH","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Indexer_set_ip"}],"name":"1ed49871_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Indexer_set_ip","attrs":{"exit_status":[],"script":"print \"indexer_nic_ipaddr=@@{indexer_ip_range[calm_array_index]}@@\"","eval_variables":["indexer_nic_ipaddr"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"d46d8842_runbook","main_task_local_reference":{"kind":"app_task","name":"1ed49871_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"cb1a56e7_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"61575fda_runbook","main_task_local_reference":{"kind":"app_task","name":"cb1a56e7_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"SplunkINDX","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"editables":{"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{SERVER_NAME}@@-INDX-@@{calm_unique}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[{"ip":"@@{indexer_nic_ipaddr}@@","type":"ASSIGNED"}],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"39e04fe9-f004-4143-82a6-e7ba4caf5597"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":12,"gpu_list":[],"memory_size_mib":12288,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n  - name: splunk\n    lock_passwd: false\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    \nssh_pwauth: True\nchpasswd:\n  list: |\n    root:@@{Root.secret}@@\n    splunk:@@{splunk.secret}@@\n  expire: false\n   "},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"192944ef-45cd-4a25-8ece-7a1b126310ba","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7.qcow2","uuid":"185dcd49-fc60-4fcc-ad57-7174a477e9a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":20480,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":2,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":3,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":4,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":5,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":6,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":7,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"SplunkMaster","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"editables":{"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{SERVER_NAME}@@-Master-@@{calm_unique}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"39e04fe9-f004-4143-82a6-e7ba4caf5597"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":6,"gpu_list":[],"memory_size_mib":6144,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n  - name: splunk\n    lock_passwd: false\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    \nssh_pwauth: True\nchpasswd:\n  list: |\n    root:@@{Root.secret}@@\n    splunk:@@{splunk.secret}@@\n  expire: false\n   \nmounts:\n  - [\/dev\/sdb1, \/opt\/splunk, \"auto\", \"defaults\", \"0\", \"0\" ]"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"192944ef-45cd-4a25-8ece-7a1b126310ba","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":null,"type":"","disk_size_mib":81920,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":{"kind":"image","type":"","name":"CentOS7.qcow2","uuid":"185dcd49-fc60-4fcc-ad57-7174a477e9a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"sh_nic_apaddr"}],"name":"c96a0722_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"sh_nic_apaddr","attrs":{"exit_status":[],"script":"print \"sh_nic_ipaddr=@@{sh_ip_range[calm_array_index]}@@\"","eval_variables":["sh_nic_ipaddr"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"10865c27_runbook","main_task_local_reference":{"kind":"app_task","name":"c96a0722_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"25c98921_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"039d045f_runbook","main_task_local_reference":{"kind":"app_task","name":"25c98921_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"SplunkSH","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"editables":{"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{SERVER_NAME}@@-SH-@@{calm_unique}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[{"ip":"@@{sh_nic_ipaddr}@@","type":"ASSIGNED"}],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"39e04fe9-f004-4143-82a6-e7ba4caf5597"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":6,"gpu_list":[],"memory_size_mib":6144,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n  - name: splunk\n    lock_passwd: false\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    \nssh_pwauth: True\nchpasswd:\n  list: |\n    root:@@{Root.secret}@@\n    splunk:@@{splunk.secret}@@\n  expire: false\n   \nmounts:\n  - [\/dev\/sdb1, \/opt\/splunk, \"auto\", \"defaults\", \"0\", \"0\" ]"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"192944ef-45cd-4a25-8ece-7a1b126310ba","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7.qcow2","uuid":"185dcd49-fc60-4fcc-ad57-7174a477e9a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":81920,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"centos","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"EKDBSyyok5nlnj8qg8VqdE009RX14eJjlEU59w27dgQLE0rdIz0KeTOkdKxATXvzePVrw\/cdFELO8GFp+uRNjXYgCxflMUZ4D54JUc1ERcfnoPtDGITSyJZxNmWI\/x58Jbf9nVmic+Q47D6\/LB7c\/0SgIbVXaBZGn8T0MWdySOEHw5RBzTHNKi5WzMCK0aLsswN5Rp5Q8iQvbaAuftrejHbVTfm5Wxd4ScYMqX9GaMFiowy0XZE19AtvjK3c+yWBeXzIbYZzWLuNk7G2j94Ddi9X6NLgjGcIvYouiR9w4YkhwZXITqdMSpyuY\/DIrJepgochGYQ8EN9DHfkGfFIKKcvGBUPPVqcsPdTxSgTJ+m35GMkRS1sQJPIyG8RRz3FryoeWzfI9ZZdut0keM+omBIF+jyWRCerq2CbIkLdceades45iCBrVeuv\/anzSZK+Qv81H4xU7g+C37ESiCx6jTuRtdVPSugXeyDqhKmnWLtKqv5xjI1bNJUUUdMzeMKEvl+bSzlbHrOscvziJ7raTfgHi+B2QFW+7ux2UHJuCtf\/kP4cF7rmD1qfGBby1f0X0pBMyGZAouXXAj5u0AlDIogb16RkiIXuXXTkfXE9WEFFnMpHQvPkjRosRahezY\/qO50YqA4I6ANQK3qks3uGR\/tEmjIzAJmefyioqt2+00x6Y+8YA9alh0c13ZDO6IMcldsp7Gi1My95GFjUBEGnZh5v17aus9bBICaBu+bx6rdRenwqQFT2EG2smpW\/hLpZKfRERB7gWs1XuDB015TfQjP1MGFbH60ysGTSigHeR098hq7OwnB8ARVZKxXWS5+essPEwrwwYgKE0RbRPe6x2WQ5LQDahGeoFQZnNJYOfEWts6AMoaawfRJmmEr\/D1c3RzF4JwVIzRE2ZyqIY0uNLkQujahtItdV3NaN6gGoeJOsjbNcoNjexv573zlP8+\/g4B2UyPh9oDj12xuewk4GbMuI8FSoUZc0LpVaZhoLkAznpJ2+u02We4EDcSwYmqT6hPcjXtarBW06mGp7ytnqgHC9XpgH8D9A8gJcmSlt285\/Qpl4gev9mc2sRbuo8I7bPwD+53uLUZNsScnnB6M9StQIh\/IECKEOmAk5vIAUKZPGt4qaRVrk+K5s\/994UzDSsXq+UHH+pjv7BfpK3\/\/5G3c+M4BgbUhPY8WnhaCuePDK+AXKhSjgMTO8FvIIRhx0q3pA1gSmdR4WwcV3o+uojVbcQNRRQohkAl7LbQW\/CtGtH\/XsM2AXsMMYPo45XZpue41i0Sa6pRSNQMhU1fFAtqMzMc1ZyvtL1sg+x7p4mCJqBMuCuYLmuLwKjCvjEMJAFnGlYfJraZxCGKRy4LV\/MTkSHABK1lE7ClzjsHfN1dHEgLaCeWDCs9YWCeVzWx0huqcjzKUGEiYEUAAYaDBfSeQFGeWUJ0upl4+9GeSajGTlc8q1ssmlzEXjKs9nqalMUdMFZKgCGzbLaYwe\/5pqzMhR3dkrqfnEivWp4krWYsfOq0FeUqpUoipGbCPP\/b2C2wTdfL34vfrpzrBY+\/IouBBreVClHCWe5WzwHq8e4XgsprtoxnJCQezcnNHLxjfTp5hYOl4v0xImcBxlUbxdwP2\/9TZoUgHmw7oeA6VAtLAhaPJWHBVtr+09s7gjoM2ZxEB30FBxWrXIi6JS357p8YVSTFwyzVasg+DCWidxne+BxndtpGvCJPH8Ri0LQ5CbGVSSdGjM819Ge3w8rlHLt9hWTdc5OCI4wVeiRYnb3db4tngHwlVrdfQeFD27kbnUnkRzzlARiivcR9brv4wI3EJX+H58DApwfQ2dhpb8tfO+tFLXf\/LDqc+DmPZFtzepX5iXhLWJ0vbIVCHoikCZRDDTiuus+RMtkEjeYQU2IE5oiN7BeENiNoqR+FxU2SgPJkOjzPaWx9iZ3IhU5RZ9nocJCRVi4Pp1dasPqi\/wcLZ7IA5PQfORUF7t68K4b2mPtzqQf0YNy4Eds+085eeqsSpz2MdqZ8hyVjuhgB8IG0k0je6ApCzotVRB7qhKv3xxnPYiFsmQx97WN1LrintQypnqwgPP0juShScJ81qK0GxdXTPruklVVrblF0trImVjB2CLAuGNGE0\/4pfe4z1EKpOcYJwFZrNswL61Rhjj9dD1M1sF2opn9OmgZYYQQ4Vyy\/fEEXpcArCw1xARNQbmbOaJJcQQzVnBWMia37LE4xqpDkmXBoKzcdbZ1WwiUzl3o2i\/+Co2SyBsM9eHRCko5nBFWue\/5aJDWwz\/NOqtdYq8avtgXlVZtZ5d8g+iYy5GPjQ3fTWBhFSyL\/Syi2TzBETufnQMS9kn9amx0yLgYS7gX\/\/PUio3wYPvW02pQ3tmTmAKk3o+TSzF7ixs3BRlpmi\/aqyYQWNyzYnI+2TqtfydrwE5zZkGCuyQzd6xDLbH5qYNzMXbnj1b5nYWQNM+\/SeMncOHPeF1\/qx4iC2Qs\/yqQ5JjwopT1Ulrezb\/tFTHMdm34:utf-8"},"name":"Splunk_VM"},{"username":"root","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"6rT1g92+JPhjvvbNGs\/\/HD2l8pWRAoUGpJo4IYcov4SU4OlZYKByRaVU:utf-8"},"name":"Root"},{"username":"splunk","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"36fYJv\/TZwpHg\/dhNRxOnenflsnGgv+IIG7MDaTBBjhItcNlrvCEXe7M:utf-8"},"name":"splunk"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Splunk_INDX"}],"name":"Package1","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Add Disk"},{"kind":"app_task","name":"Setup_OS"},{"kind":"app_task","name":"Install_INDX"}],"name":"8b8e1190_dag","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Add Disk"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Setup_OS"}},{"from_task_reference":{"kind":"app_task","name":"Setup_OS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_INDX"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Add Disk","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n# install LVM\nsudo yum install -y lvm2\n\n# Prep LVM pvols\nsudo pvcreate -y \/dev\/sd[b-g]\n\n# Create Splunk DIR\nsudo mkdir \/opt\/splunk\n\n# 6 disk LVM\nsudo vgcreate splunk_vg6 \/dev\/sd[b-g]\nsudo lvcreate -l 100%FREE -i 6 -I 64 -n splunk_vol6 splunk_vg6\nsudo mkfs.ext4 -F -m 1 -v \/dev\/splunk_vg6\/splunk_vol6\nsudo tune2fs -o journal_data_writeback \/dev\/splunk_vg6\/splunk_vol6\n\n# Write mounts to fstab\necho \"\/dev\/splunk_vg6\/splunk_vol6 \/opt\/splunk ext4 noatime,data=writeback,barrier=0,nobh,errors=remount-ro 0 1\" | sudo tee -a \/etc\/fstab\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Setup_OS","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set Firewalld to stop and disable\nsudo systemctl stop firewalld\nsudo systemctl disable firewalld\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@-@@{calm_unique}@@\nsudo hostnamectl status\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install_INDX","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\n#wget -O splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1&product=splunk&filename=splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz&wget=true'\nwget -O splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1.1&product=splunk&filename=splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz&wget=true'\n\n# Fetch Splunk RPM\n\n# User and Group\nsudo mount -a\n# sudo mkdir \/opt\/splunk\nsudo groupadd splunk\nsudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Untar the binaries\ngunzip splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz\ntar -xvf splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tar\n\n# Rum SPlunk RPM\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\nsudo chown -R splunk: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\n#splunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Copy data to server.conf for slave nodes\n# export MasterIP=@@{Splunk_Master.address}@@\n# MasterIP = MIP:8089\necho '[replication_port:\/\/9887]'  >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'master_uri = https:\/\/@@{Splunk_Master.address}@@:8089' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = slave' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n\n# Pause for 60 seconds to allow Master node to come online\n#sleep 60s\n\n\n# Start the splunk service again\nsplunk restart\n\necho 'Splunk Install Complete!'","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1981290_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"ef4a5c16_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"74e6f4b4_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Splunk_Master"}],"name":"Package_Master","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Setup_OS"},{"kind":"app_task","name":"Install_Master"},{"kind":"app_task","name":"Enable SmartStore"},{"kind":"app_task","name":"Add Disk"}],"name":"8b8e1190_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install_Master"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Enable SmartStore"}},{"from_task_reference":{"kind":"app_task","name":"Add Disk"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Setup_OS"}},{"from_task_reference":{"kind":"app_task","name":"Setup_OS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_Master"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Setup_OS","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set Firewalld to stop and disable\nsudo systemctl stop firewalld\nsudo systemctl disable firewalld\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@\nsudo hostnamectl status\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install_Master","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\n#wget -O splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1&product=splunk&filename=splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz&wget=true'\nwget -O splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1.1&product=splunk&filename=splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz&wget=true'\n# User and Group\n# sudo mkdir \/opt\/splunk\n# sudo groupadd splunk\n# sudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Gather master IP for Indexers\n\n# Untar the binaries\ngunzip splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz\ntar -xvf splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tar\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\nsudo chown -R splunk: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\nsplunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Set Master node config\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = master' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'replication_factor = 1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'search_factor = 1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'cluster_label = cluster1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n# Start the splunk service again\nsplunk start\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Enable SmartStore","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n#Change settings if you S3\n\n#Smart Store S3 Setup\n#echo '[volume:s3]'  >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'storageType = remote' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'path = s3:\/\/@@{BucketVolume}@@\/' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'remote.s3.access_key = @@{S3_ACCESS_KEY}@@' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'remote.s3.secret_key = @@{S3_SECRET_KEY}@@' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'remote.s3.endpoint = https:\/\/@@{Bucket_name_IP}@@' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'remote.s3.auth_region = us-east-1' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n\n#Send Change\n#cd \/opt\/splunk\/bin\n#.\/splunk login -auth admin:@@{SPLUNK_ADMIN_PASSWORD}@@\n#.\/splunk apply cluster-bundle --answer-yes\n\n#echo 'Splunk Install Complete!'\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Add Disk","state":"NOT_VALIDATED","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n#fdisk New disk\nprintf 'o\\nn\\np\\n1\\n\\n\\nw' | fdisk \/dev\/sda\n\n#Sleep 5s for partition to complete\nsleep 5s\n\n#New disk make xfs\nmkfs.xfs \/dev\/sda1\n\n#mount disk\nmount \/dev\/sda1 \/opt\/splunk","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1981290_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"ef4a5c16_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"74e6f4b4_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Splunk_SH"}],"name":"Package_SH","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Setup_OS"},{"kind":"app_task","name":"Install_SH"},{"kind":"app_task","name":"Add Disk"}],"name":"8b8e1190_dag_cloned_1_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Setup_OS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_SH"}},{"from_task_reference":{"kind":"app_task","name":"Add Disk"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Setup_OS"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Setup_OS","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set Firewalld to stop and disable\nsudo systemctl stop firewalld\nsudo systemctl disable firewalld\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@\nsudo hostnamectl status\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install_SH","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\n#wget -O splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1&product=splunk&filename=splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz&wget=true'\nwget -O splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1.1&product=splunk&filename=splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz&wget=true'\n\n# User and Group\n# sudo mkdir \/opt\/splunk\n# sudo groupadd splunk\n#sudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Untar the binaries\ngunzip splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz\ntar -xvf splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tar\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\nsudo chown -R splunk: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\nsplunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Copy data to server.conf for slave nodes\n# export MasterIP=@@{Splunk_Master.address}@@\n#MasterIP=MIP:8089\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'master_uri = https:\/\/@@{Splunk_Master.address}@@:8089' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = searchhead' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n# Pause for 60 seconds to allow Master node to come online\npause 60\n\n# Start the splunk service again\nsplunk start --answer-yes --no-prompt --accept-license\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Add Disk","state":"NOT_VALIDATED","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n#fdisk New disk\nprintf 'o\\nn\\np\\n1\\n\\n\\nw' | fdisk \/dev\/sdb\n\n#Sleep 5s for partition to complete\nsleep 5s\n\n#New disk make xfs\nmkfs.xfs \/dev\/sdb1\n\n#mount disk\nmount \/dev\/sdb1 \/opt\/splunk","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1981290_runbook_cloned_0_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag_cloned_1_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"ef4a5c16_dag_cloned_1_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"74e6f4b4_runbook_cloned_0_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag_cloned_1_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"0cef6335_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"5","package_local_reference_list":[{"kind":"app_package","name":"Package1"}],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"0cef6335_deployment_cloned_0","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package_Master"}],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkMaster"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"0cef6335_deployment_cloned_0_cloned_0","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Package_SH"}],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"Splunk_App_Profile","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"INSTANCE_PUBLIC_KEY","value":"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCiK81m7NPZ47wd1yr3o\/gQQJiAJem5gnUVqgRiSPp8\/T\/Q+msDV490nZXlM1vLO2dT5wmtM6znghwDkr5qkxo51fNVtBsqplElQXHKJ2VHiXnF4FErYN8zaXsFLuObcWW6Fx+sOZHapXjEkpJbMdRBtNABh0yn6H5EJOw8DPHeUnwZfgPuCIUwZ7nxP+bSoDSaREYXuhN8lgQyzQH2BTHfwsntZtDtEvyR7\/10FUsHMCMLayeDM3eMLCkCqN4twMF8AUdc\/eZ6utjc5Iqdd98BFxlPj1CxhfWuRcTQNnZRJyfzqmNWnG8oJayGUg\/NnkHq1D2VAzd3uK\/5LDyOCQ2\/ james.brown@JBrownIA-MBP1.local","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SERVER_NAME","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"SPLUNK_ADMIN_PASSWORD","value":"iqrsSzdsONSXdeBJjYfHLnbN1nP0Fcls+RvFicfx1m8=:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"SPLUNK_LICENSE","value":"8+nTGqw5wl7A5q229fH4W+YDq+5QBoBM2C4hg8ZpvKg=:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"BucketVolume","value":"splunk-cold","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"S3_ACCESS_KEY","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"S3_SECRET_KEY","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Bucket_name_IP","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"indexer_ip_range","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"sh_ip_range","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"type":"USER"},"name":"Splunk-Static_IP"},"api_version":"3.0","metadata":{"last_update_time":"1582220522755591","kind":"blueprint","spec_version":45,"creation_time":"1578333977824794","name":"Splunk-Static_IP"}}