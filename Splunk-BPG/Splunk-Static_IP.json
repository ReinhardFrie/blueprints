{"status":{},"contains_secrets":true,"product_version":"2.9.8.1","spec":{"description":"Splunk 7.3.1.1 - 60 day trial of Enterprise\nSmart store will be configured via the variables.\nWhen configuring S3 buckets:\n1) The buckets must have read, write, and delete permissions.\n","resources":{"client_attrs":{"None":{"y":-174.5,"x":371.25},"0cef6335_deployment_cloned_0_cloned_0":{"y":-243.1251787875,"x":691.9035381762},"0cef6335_deployment_cloned_0":{"y":-237.1239337803,"x":349.2966811172},"0cef6335_deployment":{"y":-241.7038538528,"x":502.8241319589}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"436b8806_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6fa942e0_runbook","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a33e37d9_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffa55735_runbook","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e3e43d46_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42f57ffc_runbook","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c56edf45_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ab6e619_runbook","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2cd45802_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"642b36dd_runbook","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag"},"variable_list":[]},"name":"action_stop"}],"depends_on_list":[],"name":"Splunk_INDX","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"436b8806_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6fa942e0_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a33e37d9_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffa55735_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e3e43d46_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42f57ffc_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag_cloned_1"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c56edf45_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ab6e619_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2cd45802_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"642b36dd_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag_cloned_1"},"variable_list":[]},"name":"action_stop"}],"depends_on_list":[],"name":"Splunk_Master","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"436b8806_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6fa942e0_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"436b8806_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a33e37d9_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ffa55735_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"a33e37d9_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_delete"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e3e43d46_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"42f57ffc_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"e3e43d46_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_restart"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c56edf45_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"7ab6e619_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"c56edf45_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"2cd45802_dag_cloned_1_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"642b36dd_runbook_cloned_0_cloned_0","main_task_local_reference":{"kind":"app_task","name":"2cd45802_dag_cloned_1_cloned_1"},"variable_list":[]},"name":"action_stop"}],"depends_on_list":[],"name":"Splunk_SH","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Indexer_set_ip"}],"name":"1ed49871_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Indexer_set_ip","attrs":{"exit_status":[],"script":"print \"indexer_nic_ipaddr=@@{indexer_ip_range[calm_array_index]}@@\"","eval_variables":["indexer_nic_ipaddr"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"d46d8842_runbook","main_task_local_reference":{"kind":"app_task","name":"1ed49871_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"cb1a56e7_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"61575fda_runbook","main_task_local_reference":{"kind":"app_task","name":"cb1a56e7_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"SplunkINDX","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"editables":{"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{SERVER_NAME}@@-INDX-@@{calm_unique}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[{"ip":"@@{indexer_nic_ipaddr}@@","type":"ASSIGNED"}],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"39e04fe9-f004-4143-82a6-e7ba4caf5597"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":12,"gpu_list":[],"memory_size_mib":12288,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n  - name: splunk\n    lock_passwd: false\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    \nssh_pwauth: True\nchpasswd:\n  list: |\n    root:@@{Root.secret}@@\n    splunk:@@{splunk.secret}@@\n  expire: false\n   "},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"192944ef-45cd-4a25-8ece-7a1b126310ba","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7.qcow2","uuid":"185dcd49-fc60-4fcc-ad57-7174a477e9a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":20480,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":2,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":3,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":4,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":5,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":6,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":860160,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":7,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkMaster"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"5400482d_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"f1a3bfe7_runbook","main_task_local_reference":{"kind":"app_task","name":"5400482d_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkMaster"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"1a5177e1_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9fed1d97_runbook","main_task_local_reference":{"kind":"app_task","name":"1a5177e1_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"SplunkMaster","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"editables":{"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{SERVER_NAME}@@-Master-@@{calm_unique}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"39e04fe9-f004-4143-82a6-e7ba4caf5597"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":6,"gpu_list":[],"memory_size_mib":6144,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n  - name: splunk\n    lock_passwd: false\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    \nssh_pwauth: True\nchpasswd:\n  list: |\n    root:@@{Root.secret}@@\n    splunk:@@{splunk.secret}@@\n  expire: false\n   \nmounts:\n  - [\/dev\/sdb1, \/opt\/splunk, \"auto\", \"defaults\", \"0\", \"0\" ]"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"192944ef-45cd-4a25-8ece-7a1b126310ba","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":null,"type":"","disk_size_mib":81920,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":{"kind":"image","type":"","name":"CentOS7.qcow2","uuid":"185dcd49-fc60-4fcc-ad57-7174a477e9a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"sh_nic_apaddr"}],"name":"c96a0722_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"sh_nic_apaddr","attrs":{"exit_status":[],"script":"print \"sh_nic_ipaddr=@@{sh_ip_range[calm_array_index]}@@\"","eval_variables":["sh_nic_ipaddr"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"description":"","name":"10865c27_runbook","main_task_local_reference":{"kind":"app_task","name":"c96a0722_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"25c98921_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"039d045f_runbook","main_task_local_reference":{"kind":"app_task","name":"25c98921_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"SplunkSH","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"}},"editables":{"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"boot_config":true,"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{SERVER_NAME}@@-SH-@@{calm_unique}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[{"ip":"@@{sh_nic_ipaddr}@@","type":"ASSIGNED"}],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"39e04fe9-f004-4143-82a6-e7ba4caf5597"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":6,"gpu_list":[],"memory_size_mib":6144,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n  - name: splunk\n    lock_passwd: false\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n    \nssh_pwauth: True\nchpasswd:\n  list: |\n    root:@@{Root.secret}@@\n    splunk:@@{splunk.secret}@@\n  expire: false\n   \nmounts:\n  - [\/dev\/sdb1, \/opt\/splunk, \"auto\", \"defaults\", \"0\", \"0\" ]"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"192944ef-45cd-4a25-8ece-7a1b126310ba","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7.qcow2","uuid":"185dcd49-fc60-4fcc-ad57-7174a477e9a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":81920,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"centos","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"vSrN5qwFIVwHnjLQXl0JSqsplLfkepRab4PulIMJcIRQNHWf5ZONfZedsk04YeOXVBw9d\/OiHiuw1yfU0q+PW8J+Ju9hCimSzFjR1PHO9hNvjvX8Dg3eRcgw4d9+wyJ5wwtZU1bk1B9MK\/Hso820l0pnuMJaYg5jK0vInDseujdF7TlXTW4Z8zRvby4OmKGfkAh5YQldyGietZ+WzWd+hncE4Bt\/6OqLEWfpcc7h3QxNHhh4esKYV7QFKMoRk+rDup3kLBzLaDFGpSFo9oydrXkZWYafjmk28a5SqB\/yQB0mQ870uPLAD50fCVtS7457XwNHQHX47mD1ZnpqVF2r18Cm+HappiporZ\/Hu57TO89q7kC5wmO9BgChWoZffC9dYKL23DUGkpD\/lM9PNWzKgFR1ar8ej8uCVAUoy3pHMVNnAqaMzfxOx0FTpyj2epgrux+aX7h4QmLAylVtdtWx7R\/AanEEeVOxrCLxRI0XrfR\/bxOQHobwgxK9Wzl6ilcq3U1G02NZNiBSmWpYMLEWjRfjY18KhFIdQoVLxkuOjmvomVeAf4hbffqvou1ivz8kQykmjuaOK69RaugGHNydi8k2\/Q4bKNKWoIXWjEyi8Mcums0RbUE8oFcytuPkSHgYamYJ8Ie5TnPMTVlD4A5M+6W7z73oB\/PNjkD5Ik3DiIF64VEiCdRFzor9P0blZv5WXyApKofw3+a5jRbeCLEHCSN+v0djIto4ruE5lvO19goi90VOswVZ3exIJLJQWkuGYWf\/ld4RhiGYcWKWvj3vFz6ZgYfMoRXQ\/QeqKQKcRbVhPDEiCPAMCFyJ8oy8f0cgWeuZOBjWB6MjaNnyVuOtQmXzeASw\/30ga6VxQaOPuMOQ6g\/s\/pQBOE4yooDfxHod4ADhRhf7piYXKhrqHydzPifw2+pPqnAM6eXf+j9eVQusijdzs3mE3oAamvQxbaRLz5+fQQLUJpusY4Qi9JtEzKWu+s\/848D0k6g+qsJQYiIZXODyLggibShSQp8PAh\/yC9EnmgOlx6rYJ2cOGSj3wejyTAevepKPS0qs2caeQW0z1BbJ\/JFR+zgTwFPPqq6seVmqcryfLk4EowO9NXx4\/rN3HefR5BbQSATmHeA4XgJOoHe1jT67kq+xYLWVYtsDgkuyF1omHy6zzORUi1bxgVRPbIK2WkDQxGd85NC0fNq13DvkUxMHUUkstqymM5pwzR9COQDV45LhUXFqUgZCgrACR20kYXgQMsr0iWf8QSiEHCDTfeB0SXohgRz8ZZu3HChNDNtkPs31PtLE990pJxht1hQHw1jREZfkbUWZ2jzvXTBeuPYJUcnINnXn8c3jtKsJqYA1dv8VVoHvaL7J1Nb4+F6C8F1hWz+4zM0m0k5l3BhFbk2Ayb3O1igb6S76aQAZLUL\/wl6xaK06kKx+H2A2lmlr+C42Oug6cdJ75iTtdzXv2Jt5Yfq\/QQ3L0kMio7DmB5LWrepyBxmGNcUbzklWffb4cUOrZVyTk3OOnlfcLpAU2ar3Gs3T1yNf19T2AsmHg2+F3ba8Lh\/aIYie+RnB6blbgevR0hyt4mSrs4cDufmwilrCbceoKAp2BV1anEaRd34gLBsHuwYd4Lhq5PIhkquDcyW6lZdttoOkAwNBdqDID0+CbrsA4OA6SC0pE2z1q9hu5B+HNcTDyN920xBvCvOFgFIUe\/+NuLyMPwHveTS7qBR0Oi144Rhm15gqRvjdV9M0GPFL+m9qBf+ls9v4PrjyUUdkBfk6I3R2hQDxhBvwUnbdw0w5vyavrMZkjXn+WMNMi0K3A4hDQxQzbkOAfK8ZiHkX5\/fjVT7GhXmZTsh5h6yGWZPLRo65iIkDDMi+dRXLjJuV4XCZqYBSvxE7hLOZVvXneuTMeuiz6ZuKTb4jCDgZqoF+3v6C1ffl4OEA+3vRlKXqan1ydHkntKoOzQX1HU3m8RHL05uIeIIRXNe3TgZ1oyqqAmnp5FLxaLj\/fDixlGq2UXXfKzlZOC7jR2QkTlZ8ffuiHJuiZDLNdZonocRr4lywzKBUWQ6LtH+L9WcSo83K0wYNR9FBzC7njme9Iq4WSgUvbI6y\/AGvcfqpwmHnumUxJxL4stLZxHTpgx9obgAY0gKCMMKvep\/NDx0vrwMFVi7LOSz9jpvRuVYcXrQLHh\/gDF3U19mFAWTRDjgv\/Hq87hpXNwAPuOFOwNVNGll46CYuaFPQ9Fgt7iTswQ1Xx4MQNdIKfJsA0XTk6AYuyTkqJimhXcnB1pjFpdAG3R061kMjlkp1Zl\/fsQs\/tYrdw2fdDxQfBAoKugWUYy2oz4iNe+Hj6x5dj5Fo40K4uVsDdzFxtI8CoHKkCYcgPR4qHq3LCNTVxcSJzr\/MZJmH1rR0qjt2XBF8kQnovl\/VGqkQaMth3AuTHnsPuEcm\/F9EV0EW00iYyasuFWq4Bl3zjlZ6Aofe6EPFiZ1\/leIraLnzzFUMVdsWqsi6pXH3XvM8KsDBpluo+XuCJrsC:utf-8"},"name":"Splunk_VM"},{"username":"root","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"kmXyPVqwUygcP3QFt\/shAtHYdWdzLwMIzyF75\/Pq6OHnqM4fLa+fZtDz:utf-8"},"name":"Root"},{"username":"splunk","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"+ZrMuoD+hBIpF0lZRNzacPG5ACZGcGlzhIqniFEGHOKW4bKR67Mstu3\/:utf-8"},"name":"splunk"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Splunk_INDX"}],"name":"Package1","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Add Disk"},{"kind":"app_task","name":"Setup_OS"},{"kind":"app_task","name":"Install_INDX"}],"name":"8b8e1190_dag","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Add Disk"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Setup_OS"}},{"from_task_reference":{"kind":"app_task","name":"Setup_OS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_INDX"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Add Disk","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n# install LVM\nsudo yum install -y lvm2\n\n# Prep LVM pvols\nsudo pvcreate -y \/dev\/sd[b-g]\n\n# Create Splunk DIR\nsudo mkdir \/opt\/splunk\n\n# 6 disk LVM\nsudo vgcreate splunk_vg6 \/dev\/sd[b-g]\nsudo lvcreate -l 100%FREE -i 6 -I 64 -n splunk_vol6 splunk_vg6\nsudo mkfs.ext4 -F -m 1 -v \/dev\/splunk_vg6\/splunk_vol6\nsudo tune2fs -o journal_data_writeback \/dev\/splunk_vg6\/splunk_vol6\n\n# Write mounts to fstab\necho \"\/dev\/splunk_vg6\/splunk_vol6 \/opt\/splunk ext4 noatime,data=writeback,barrier=0,nobh,errors=remount-ro 0 1\" | sudo tee -a \/etc\/fstab\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Setup_OS","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set Firewalld to stop and disable\nsudo systemctl stop firewalld\nsudo systemctl disable firewalld\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@-@@{calm_unique}@@\nsudo hostnamectl status\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_INDX"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install_INDX","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\n#wget -O splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1&product=splunk&filename=splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz&wget=true'\nwget -O splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1.1&product=splunk&filename=splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz&wget=true'\n\n# Fetch Splunk RPM\n\n# User and Group\nsudo mount -a\n# sudo mkdir \/opt\/splunk\nsudo groupadd splunk\nsudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Untar the binaries\ngunzip splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz\ntar -xvf splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tar\n\n# Rum SPlunk RPM\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\nsudo chown -R splunk: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\n#splunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Copy data to server.conf for slave nodes\n# export MasterIP=@@{Splunk_Master.address}@@\n# MasterIP = MIP:8089\necho '[replication_port:\/\/9887]'  >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'master_uri = https:\/\/@@{Splunk_Master.address}@@:8089' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = slave' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n\n# Pause for 60 seconds to allow Master node to come online\n#sleep 60s\n\n\n# Start the splunk service again\nsplunk restart\n\necho 'Splunk Install Complete!'","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1981290_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"ef4a5c16_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"74e6f4b4_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Splunk_Master"}],"name":"Package_Master","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Add Disk"},{"kind":"app_task","name":"Setup_OS"},{"kind":"app_task","name":"Install_Master"},{"kind":"app_task","name":"Enable SmartStore"}],"name":"8b8e1190_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install_Master"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Enable SmartStore"}},{"from_task_reference":{"kind":"app_task","name":"Add Disk"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Setup_OS"}},{"from_task_reference":{"kind":"app_task","name":"Setup_OS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_Master"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Add Disk","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n#fdisk New disk\nprintf 'o\\nn\\np\\n1\\n\\n\\nw' | fdisk \/dev\/sda\n\n#Sleep 5s for partition to complete\nsleep 5s\n\n#New disk make xfs\nmkfs.xfs \/dev\/sda1\n\n#mount disk\nmount \/dev\/sda1 \/opt\/splunk","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Setup_OS","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set Firewalld to stop and disable\nsudo systemctl stop firewalld\nsudo systemctl disable firewalld\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@\nsudo hostnamectl status\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install_Master","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\n#wget -O splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1&product=splunk&filename=splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz&wget=true'\nwget -O splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1.1&product=splunk&filename=splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz&wget=true'\n# User and Group\n# sudo mkdir \/opt\/splunk\n# sudo groupadd splunk\n# sudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Gather master IP for Indexers\n\n# Untar the binaries\ngunzip splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz\ntar -xvf splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tar\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\nsudo chown -R splunk: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\nsplunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Set Master node config\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = master' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'replication_factor = 1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'search_factor = 1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'cluster_label = cluster1' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n# Start the splunk service again\nsplunk start\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Enable SmartStore","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n#Change settings if you S3\n\n#Smart Store S3 Setup\n#echo '[volume:s3]'  >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'storageType = remote' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'path = s3:\/\/@@{BucketVolume}@@\/' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'remote.s3.access_key = @@{S3_ACCESS_KEY}@@' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'remote.s3.secret_key = @@{S3_SECRET_KEY}@@' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'remote.s3.endpoint = https:\/\/@@{Bucket_name_IP}@@' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n#echo 'remote.s3.auth_region = us-east-1' >> \/opt\/splunk\/etc\/master-apps\/_cluster\/local\/indexes.conf\n\n#Send Change\n#cd \/opt\/splunk\/bin\n#.\/splunk login -auth admin:@@{SPLUNK_ADMIN_PASSWORD}@@\n#.\/splunk apply cluster-bundle --answer-yes\n\n#echo 'Splunk Install Complete!'\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1981290_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_Master"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"ef4a5c16_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"74e6f4b4_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Splunk_SH"}],"name":"Package_SH","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Add Disk"},{"kind":"app_task","name":"Setup_OS"},{"kind":"app_task","name":"Install_SH"}],"name":"8b8e1190_dag_cloned_1_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Setup_OS"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install_SH"}},{"from_task_reference":{"kind":"app_task","name":"Add Disk"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Setup_OS"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Add Disk","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n#fdisk New disk\nprintf 'o\\nn\\np\\n1\\n\\n\\nw' | fdisk \/dev\/sdb\n\n#Sleep 5s for partition to complete\nsleep 5s\n\n#New disk make xfs\nmkfs.xfs \/dev\/sdb1\n\n#mount disk\nmount \/dev\/sdb1 \/opt\/splunk","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Setup_OS","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\nset -ex\n\n# Disable THP\n# Check the current THP flags set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Disable THP\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/enabled\necho 'never' > sudo tee \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Check if the flags are set\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/enabled\nsudo cat \/sys\/kernel\/mm\/transparent_hugepage\/defrag\n\n# Set the file descriptor limit\nsudo sysctl -w fs.file-max=65535\necho 'Current value of file descriptors set is ' \nsudo cat \/proc\/sys\/fs\/file-max\n\n# Set Firewalld to stop and disable\nsudo systemctl stop firewalld\nsudo systemctl disable firewalld\n\n# Set hostname\nsudo hostnamectl set-hostname @@{SERVER_NAME}@@\nsudo hostnamectl status\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Splunk_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install_SH","state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n# Install wget if it doesn't exist\nsudo yum -y install wget\n\n# Fetch Splunk binary\n#wget -O splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1&product=splunk&filename=splunk-7.3.1-bd63e13aa157-Linux-x86_64.tgz&wget=true'\nwget -O splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz 'https:\/\/www.splunk.com\/bin\/splunk\/DownloadActivityServlet?architecture=x86_64&platform=linux&version=7.3.1.1&product=splunk&filename=splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz&wget=true'\n\n# User and Group\n# sudo mkdir \/opt\/splunk\n# sudo groupadd splunk\n#sudo useradd -d \/opt\/splunk -m -g splunk splunk\n\n# Untar the binaries\ngunzip splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tgz\ntar -xvf splunk-7.3.1.1-7651b7244cf2-Linux-x86_64.tar\n\n# Set the admin password\nexport PASS=@@{SPLUNK_ADMIN_PASSWORD}@@\necho '[user_info]' > \/tmp\/user-seed.conf\necho 'USERNAME = admin' >> \/tmp\/user-seed.conf\necho 'PASSWORD = '$PASS >> \/tmp\/user-seed.conf\n\ncat \/tmp\/user-seed.conf\n\n# move Splunk setup to \/opt\nexport SPLUNK_HOME=\/opt\/splunk\nexport PATH=$SPLUNK_HOME\/bin:$PATH\nsudo cp -rp splunk\/* \/opt\/splunk\/\n\n# Change ownership of splunk folder\nsudo chown -R centos: \/opt\/splunk\/\nsudo chown -R splunk: \/opt\/splunk\/\n\n# Start splunk service\nsplunk start --answer-yes --no-prompt --accept-license\n\n# Stop splunk service\nsplunk stop\n\n# Copy the user credentials file\nsudo mv \/tmp\/user-seed.conf $SPLUNK_HOME\/etc\/system\/local\nsudo chown -R centos: $SPLUNK_HOME\/etc\/system\/local\/user-seed.conf\n\n# Copy data to server.conf for slave nodes\n# export MasterIP=@@{Splunk_Master.address}@@\n#MasterIP=MIP:8089\necho '[clustering]' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'master_uri = https:\/\/@@{Splunk_Master.address}@@:8089' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'mode = searchhead' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\necho 'pass4SymmKey = nutanix\/4u' >> $SPLUNK_HOME\/etc\/system\/local\/server.conf\n\n# Pause for 60 seconds to allow Master node to come online\npause 60\n\n# Start the splunk service again\nsplunk start --answer-yes --no-prompt --accept-license\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"splunk"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"c1981290_runbook_cloned_0_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"8b8e1190_dag_cloned_1_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package_SH"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"ef4a5c16_dag_cloned_1_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"74e6f4b4_runbook_cloned_0_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"ef4a5c16_dag_cloned_1_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"0cef6335_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"5","package_local_reference_list":[{"kind":"app_package","name":"Package1"}],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkINDX"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"0cef6335_deployment_cloned_0","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package_Master"}],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkMaster"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"0cef6335_deployment_cloned_0_cloned_0","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Package_SH"}],"substrate_local_reference":{"kind":"app_substrate","name":"SplunkSH"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"Splunk_App_Profile","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"INSTANCE_PUBLIC_KEY","value":"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCiK81m7NPZ47wd1yr3o\/gQQJiAJem5gnUVqgRiSPp8\/T\/Q+msDV490nZXlM1vLO2dT5wmtM6znghwDkr5qkxo51fNVtBsqplElQXHKJ2VHiXnF4FErYN8zaXsFLuObcWW6Fx+sOZHapXjEkpJbMdRBtNABh0yn6H5EJOw8DPHeUnwZfgPuCIUwZ7nxP+bSoDSaREYXuhN8lgQyzQH2BTHfwsntZtDtEvyR7\/10FUsHMCMLayeDM3eMLCkCqN4twMF8AUdc\/eZ6utjc5Iqdd98BFxlPj1CxhfWuRcTQNnZRJyfzqmNWnG8oJayGUg\/NnkHq1D2VAzd3uK\/5LDyOCQ2\/ james.brown@JBrownIA-MBP1.local","label":"","attrs":{"type":""},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"SERVER_NAME","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"SPLUNK_ADMIN_PASSWORD","value":"MkYpZfLX+hCpi2TQCk01V9nKwr+E8nYbIp\/9sctrNVo=:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"SECRET","name":"SPLUNK_LICENSE","value":"790HUnNC5CvkvnVGoYSZu2zVfkAzpMzQLk0SopzP8Jg=:utf-8","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"BucketVolume","value":"splunk-cold","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"S3_ACCESS_KEY","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"S3_SECRET_KEY","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"Bucket_name_IP","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"indexer_ip_range","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"sh_ip_range","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"Splunk_VM"},"type":"USER"},"name":"Splunk-Static_IP"},"api_version":"3.0","metadata":{"last_update_time":"1585943354879427","kind":"blueprint","spec_version":47,"creation_time":"1578333977824794","name":"Splunk-Static_IP"}}